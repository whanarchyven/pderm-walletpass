# Требования к деплою

## Код (ToDo: вынести в отдельный сервис)
- Все модули под единым проектом без workspaces для быстрых импортов и создания новых модулей
- Экспорты из модулей с возможностями уже быть привязанными к конкретным продакшен/тест базам, ключам.
- Список вариаций по каждому сервису включая домены где он должен быть
- Переключаемая песочница разработки фронта (копирование в pages основной того что там было в проекте)
- Выгрузка кода заказчику
- Выгрузка относительно одной из вариации одного из сервисов с обрезанием всего лишнего, так чтобы этот сервис оказывался в центре.

## Деплой
- Сборка на локальной машине после выгрузки вариации. Добавление в сборку сведений о текущем коммите и времени. Запрет на сборку без коммита, чтобы если в результате оно упало, можно было откатить. Хранение одной-двух предыдущих сборок по вариации с той же целью.
- Главный личный инстанс, куда по-умолчанию все закидывается.
- Возможность быстро вешать на свободные поддомены.
- Добавление сертификатов через ansible.
- Простой healthcheck чтобы быть уверенным что домены в списке вариаций это не фантазии, а там правда то что надо до сих пор висит
- Возможность уследить за тем, что кто то жрет больше и вынесения его куда-то отдельно (какая-то выгрузка статуса из pm2)
(!!! не упомянуто ранее)

- Дополнительные инстансы в случаях необходимости другой гео, под клиентов или нагрузки типа зайцев - развертка через ansible.
- Поддержка vercel.
- Какое-то решение по ключам

## Командная разработка
- Выделение нужного подмножества в новый гит-репозиторий.
- Коммит в отдельную связанную ветку при пуше в мейн
- Обновление дочернего репозитория пушем, в мейн или отдельную ветку - по ситуации